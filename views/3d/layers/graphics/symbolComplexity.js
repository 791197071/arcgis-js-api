// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.12/esri/copyright.txt for details.

define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/compilerUtils","../../../../core/has","../../../../core/maybe","../../../../symbols/support/ObjectSymbol3DLayerResource","./primitiveObjectSymbolUtils","../../webgl-engine/lib/Util","../../webgl-engine/lib/lodRendering/LodResources"],function(e,r,t,i,o,s,a,m,y,d){function n(e){return"web-style"===e.type?r.emptySymbolComplexity:P(e.symbolLayers.toArray().map(function(r){return u(e,r)}))}function P(e){for(var r=0,t=0,i=!1,o={bytesPerFeature:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerCoordinate:0}},s=0,a=e;s<a.length;s++){var m=a[s];m&&(r+=m.primitivesPerFeature,t+=m.primitivesPerCoordinate,o.bytesPerFeature+=m.memory.bytesPerFeature,o.bytesPerCoordinate+=m.memory.bytesPerCoordinate,o.draped.bytesPerFeature+=m.memory.bytesPerFeature,o.draped.bytesPerCoordinate+=m.memory.bytesPerCoordinate,i=i||m.estimated)}return{primitivesPerFeature:r,primitivesPerCoordinate:t,estimated:i,memory:o}}function u(e,r){var o=b(e,r);switch(r.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,estimated:!1,memory:o};case"fill":return"mesh-3d"===e.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!1,memory:o}:s.isSome(r.outline)&&r.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,estimated:!1,memory:o}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:o};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:o};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,estimated:!1,memory:o};case"object":if(r.resource&&r.resource.href)return{primitivesPerFeature:16,primitivesPerCoordinate:0,estimated:!0,memory:o};var m=r.resource&&r.resource.primitive||a.defaultPrimitive;return t({},p(m),{memory:o});case"path":;return{primitivesPerFeature:-4,primitivesPerCoordinate:20,estimated:!1,memory:o};case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,estimated:!1,memory:o};default:i.neverReached(r)}}function b(e,t){var a="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?r.memoryEstimators.EXTRUDE_EDGES:r.memoryEstimators.EXTRUDE;case"fill":return s.isSome(t.outline)&&t.outline.size>0?r.memoryEstimators.FILL_OUTLINE:r.memoryEstimators.FILL;case"water":return r.memoryEstimators.FILL;case"line":return r.memoryEstimators.LINE;case"path":return r.memoryEstimators.PATH;case"object":return o("enable-feature:skallweit/lod-rendering")?a?r.memoryEstimators.OBJECT_POINT_LOD:r.memoryEstimators.OBJECT_POLYGON_LOD:a?r.memoryEstimators.OBJECT_POINT:r.memoryEstimators.OBJECT_POLYGON;case"icon":case"text":return a?r.memoryEstimators.ICON_POINT:r.memoryEstimators.ICON_POLYGON;default:i.neverReached(t)}}function p(e){var r=C[e];if(r)return r;if(o("enable-feature:skallweit/lod-rendering")){var t=m.primitiveLodResources(e,null,null),i=d.geometriesFromLodLevelResources(t.levels[0]),s=i.reduce(function(e,r){return e+r.data.getIndices(y.VertexAttrConstants.POSITION).length/3},0);r={primitivesPerFeature:s,primitivesPerCoordinate:0,estimated:!1}}else{var a=m.primitiveGeometryData(e),s=a.getIndices(y.VertexAttrConstants.POSITION).length/3;r={primitivesPerFeature:s,primitivesPerCoordinate:0,estimated:!1}}return C[e]=r,r}Object.defineProperty(r,"__esModule",{value:!0}),r.emptySymbolComplexity={primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerCoordinate:0}}},r.defaultSymbolComplexity=n,r.totalSymbolComplexities=P;var C={};r.defaultSymbolLayerComplexity=u,r.defaultSymbolLayerMemoryComplexity=b,r.memoryEstimators={ICON_POINT:{bytesPerFeature:7478.781325779039,bytesPerCoordinate:0,draped:{bytesPerFeature:5712.082651558076,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9679.372971750396,bytesPerCoordinate:56.86422538239579,draped:{bytesPerFeature:7883.966873022898,bytesPerCoordinate:56.89697037586389}},OBJECT_POINT:{bytesPerFeature:5177.80657223796,bytesPerCoordinate:0,draped:{bytesPerFeature:5177.80657223796,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:7372.024890546556,bytesPerCoordinate:56.80425878144206,draped:{bytesPerFeature:7372.024890546556,bytesPerCoordinate:56.80425878144206}},OBJECT_POINT_LOD:{bytesPerFeature:1770.211558073654,bytesPerCoordinate:0,draped:{bytesPerFeature:1770.211558073654,bytesPerCoordinate:0}},OBJECT_POLYGON_LOD:{bytesPerFeature:3958.8422890890743,bytesPerCoordinate:56.88697205558441,draped:{bytesPerFeature:3958.8422890890743,bytesPerCoordinate:56.88697205558441}},LINE:{bytesPerFeature:7586.045782417972,bytesPerCoordinate:112.02132538683836,draped:{bytesPerFeature:4775.97368572266,bytesPerCoordinate:111.85995483757563}},PATH:{bytesPerFeature:7563.020535856769,bytesPerCoordinate:119.1242257528872,draped:{bytesPerFeature:7563.020535856769,bytesPerCoordinate:119.1242257528872}},FILL:{bytesPerFeature:8702.040510627665,bytesPerCoordinate:56.610361738134486,draped:{bytesPerFeature:5921.70744530372,bytesPerCoordinate:56.58839624148057}},FILL_OUTLINE:{bytesPerFeature:12168.362923563885,bytesPerCoordinate:56.265773613009564,draped:{bytesPerFeature:7929.090679733446,bytesPerCoordinate:56.17528027868163}},EXTRUDE:{bytesPerFeature:11409.738625531325,bytesPerCoordinate:56.99136098105536,draped:{bytesPerFeature:11409.738625531325,bytesPerCoordinate:56.99136098105536}},EXTRUDE_EDGES:{bytesPerFeature:19399.52461450617,bytesPerCoordinate:52.052414603432105,draped:{bytesPerFeature:19399.52461450617,bytesPerCoordinate:52.052414603432105}}}});