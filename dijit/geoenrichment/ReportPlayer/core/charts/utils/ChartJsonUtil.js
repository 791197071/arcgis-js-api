// COPYRIGHT Â© 201 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.

define(["dojo/_base/lang","./ThemeCalculator","./ChartTypes","./ChartDataLabelsTypes","../legends/ChartLegendPlacements","../legends/ChartLegendTypes","./cleanUp/_ChartJsonCleaner","./cleanUp/_ChartJsonPrettifier","./plots/supportClasses/GaugeLabelPlacement","./plots/supportClasses/WaffleLabelPlacement","./plots/supportClasses/WaffleDirections","../../../dataProvider/supportClasses/AreaDataUtil","esri/dijit/geoenrichment/utils/ObjectUtil","dojo/i18n!esri/nls/jsapi"],function(e,i,l,a,t,o,r,n,s,d,g,c,u,L){L=L.geoenrichment.dijit.ReportPlayer.ChartContainer;var b={};b.getDefaultChartSettings=function(r){r=r||{};var n=e.mixin({},r.font),c=e.mixin({},r.font);return delete c.fontSize,{isChart:!0,type:r.chartType||l.COLUMN,isMultiFeatureChart:!!r.isMultiFeatureChart,seriesItems:r.seriesItems||[],visualProperties:{width:r.width||400,height:r.height||300,barBorders:!1,view3D:!1,origin:0,backgroundColor:void 0,backgroundImageData:void 0,panelBackgroundColor:void 0,title:{text:"",align:"center",style:e.mixin({},n),verticalShift:0},xAxis:{show:!0,hideLine:!1,showTicks:!0,ticksInside:!1,hideLabels:!1,title:"",titleStyle:e.mixin({},n),style:e.mixin({},n),labelsAngle:0,lineColor:void 0,gridLines:!1,gridLinesCentered:!1,gridLinesColor:void 0,gridLinesOpacity:1,gridLinesThickness:.5,gridLinesStyle:void 0,gridStripes:!1,gridStripesColor:void 0,gridStripesColorAlt:void 0,placement:void 0},yAxis:{show:!0,hideLine:!1,showTicks:!0,ticksInside:!1,hideLabels:!1,title:"",titleStyle:e.mixin({},n),style:e.mixin({},n),labelsAngle:0,lineColor:void 0,gridLines:!1,gridLinesCentered:!1,gridLinesColor:void 0,gridLinesOpacity:1,gridLinesThickness:.5,gridLinesStyle:void 0,gridStripes:!1,gridStripesColor:void 0,gridStripesColorAlt:void 0,hideBaseLine:!1,baseLineColor:void 0,baseLineOpacity:1,baseLineThickness:.5,baseLineStyle:void 0,baseLineValue:0,showPercentSymbol:!1,showCurrencySymbol:!1,showSymbolForAllLabels:!1,showValuesAsWeightsInSeries:!1,placement:void 0},legend:{type:o.SERIES,series:{placement:t.NONE,placementOffset:10,hasBorder:!0,labelParts:"Label",style:e.mixin({},n),symbol:void 0,hideOthers:!1,showComparison:!1},minMax:{placement:t.NONE,placementOffset:3,titleStyle:e.mixin({},c),minVariableLabelStyle:e.mixin({},c),maxVariableLabelStyle:e.mixin({},c)}},isStacked:!1,columnThickness:i.DEFAULT_COLUMN_THICKNESS,columnBarGap:void 0,columnBarOpacity:1,renderColumnBarsInOppositeDirections:!1,showColumnBarBackground:!1,columnBarBackgroundColor:void 0,columnBarBackgroundOpacity:1,columnBarLineColor:void 0,columnBarLineOpacity:1,columnBarLineThickness:0,columnBarLineStyle:void 0,lineThickness:i.DEFAULT_LINE_THICKNESS,fillLineArea:!1,lineAreaOpacity:1,donutHolePercent:i.DEFAULT_DONUT_HOLE_PERCENT,donutGap:i.DEFAULT_DONUT_GAP,donutArcPercent:i.DEFAULT_DONUT_ARC_PERCENT,gaugeHolePercent:i.DEFAULT_GAUGE_HOLE_PERCENT,gaugeRangeMin:void 0,gaugeRangeMax:void 0,gaugeGap:i.DEFAULT_GAUGE_GAP,gaugeStartAngle:i.DEFAULT_GAUGE_ANGLE,gaugeArcPercent:i.DEFAULT_GAUGE_ARC_PERCENT,gaugeLabelPlacement:s.INSIDE,gaugeLabelStyle:e.mixin({},c),gaugeShowArrow:!1,gaugeArrowLineColor:void 0,gaugeArrowFillColor:void 0,gaugeConditionalStylingOthers:!1,gaugeConditionalStylingLabel:!1,gaugeShowFromToLabels:!1,gaugeFromLabelStyle:e.mixin({},c),gaugeToLabelStyle:e.mixin({},c),waffleDirection:g.DOWN,waffleShowWholePictures:!1,waffleRangeMin:void 0,waffleRangeMax:void 0,waffleLabelPlacement:d.BOTTOM,waffleLabelOffset:10,waffleHideValue:!1,waffleHideLabel:!1,waffleShowLabelAbove:!1,waffleValueStyle:e.mixin({},c),waffleLabelStyle:e.mixin({},c),waffleColumnSpace:5,waffleRowSpace:5,waffleConditionalStylingOthers:!1,waffleConditionalStylingValue:!1,waffleConditionalStylingLabel:!1,waffleNumIcons:void 0,ringBackgroundColor:void 0,columnBarShowWholePictures:!1,dataLabels:a.NONE,dataLabelsShowLabelUnder:!1,dataLabelsDecimals:0,dataLabelsStyle:e.mixin({},n),dataLabelsLabelStyle:null,dataLabelsAltColor:null,dataLabelsEnableAltColor:!1,dataLabelsInside:!1,dataLabelsStackedInColumns:!1,dataLabelsHorizontalAlign:"center",dataLabelsVerticalAlign:"middle",dataLabelsShowValuePercentSymbol:!1,dataLabelsShowValueCurrencySymbol:!1,dataLabelsAngle:0,dataLabelsMaxWidth:void 0,chartIcons:void 0,floatingIcons:void 0,showAxisIcons:!1,showChartIcons:!1,floatingTexts:void 0,sorting:void 0,conditionalStyling:void 0},comparisonInfo:void 0}},b.provideDefaultValueForMissing=function(e,i){var l=b.getDefaultChartSettings(i);return u.populateObject(e,l),e},b.cleanUpJson=function(e,i){return r.cleanUpJson(e,i)},b.prettifyJson=function(e,i){return n.prettifyJson(e,i)},b.supportsVisualProperty=function(e,i,l){return r.supportsVisualProperty(i,e,l)},b.enrichVisualPropertiesWithThemeSettings=function(i,l){var a=e.clone(i);return a.backgroundColor=a.backgroundColor||l.backgroundColor,u.populateObject(a.title.style,l.titleStyle),a.xAxis&&(u.populateObject(a.xAxis.style,l.xAxis.axisStyle),u.populateObject(a.xAxis.titleStyle,l.xAxis.titleStyle),a.xAxis.lineColor=a.xAxis.lineColor||l.xAxis.lineColor,a.xAxis.gridLinesColor=a.xAxis.gridLinesColor||l.xAxis.gridLinesColor,a.xAxis.gridLinesStyle=a.xAxis.gridLinesStyle||l.xAxis.gridLinesStyle,a.xAxis.gridStripesColor=a.xAxis.gridStripesColor||l.xAxis.gridStripesColor,a.xAxis.gridStripesColorAlt=a.xAxis.gridStripesColorAlt||l.xAxis.gridStripesColorAlt,u.populateObject(a.yAxis.style,l.yAxis.axisStyle),u.populateObject(a.yAxis.titleStyle,l.yAxis.titleStyle),a.yAxis.lineColor=a.yAxis.lineColor||l.yAxis.lineColor,a.yAxis.gridLinesColor=a.yAxis.gridLinesColor||l.yAxis.gridLinesColor,a.yAxis.gridLinesStyle=a.yAxis.gridLinesStyle||l.yAxis.gridLinesStyle,a.yAxis.gridStripesColor=a.yAxis.gridStripesColor||l.yAxis.gridStripesColor,a.yAxis.gridStripesColorAlt=a.yAxis.gridStripesColorAlt||l.yAxis.gridStripesColorAlt,a.yAxis.baseLineColor=a.yAxis.baseLineColor||l.yAxis.baseLineColor,a.yAxis.baseLineStyle=a.yAxis.baseLineStyle||l.yAxis.baseLineStyle),a.legend&&(u.populateObject(a.legend.series.style,l.legendStyle),a.legend.minMax&&(u.populateObject(a.legend.minMax.titleStyle,l.minMaxLegend.titleStyle),u.populateObject(a.legend.minMax.minVariableLabelStyle,l.minMaxLegend.minVariableLabelStyle),u.populateObject(a.legend.minMax.maxVariableLabelStyle,l.minMaxLegend.maxVariableLabelStyle))),u.populateObject(a.dataLabelsStyle,l.dataLabelsStyle),u.populateObject(a.dataLabelsLabelStyle,a.dataLabelsStyle),a.dataLabelsAltColor=a.dataLabelsAltColor||l.dataLabelsAltColor,u.populateObject(a.gaugeLabelStyle,l.gauge&&l.gauge.dataLabelStyle),a.gaugeArrowLineColor=a.gaugeArrowLineColor||l.gauge&&l.gauge.arrowIndicator.lineColor,a.gaugeArrowFillColor=a.gaugeArrowFillColor||l.gauge&&l.gauge.arrowIndicator.backgroundColor,u.populateObject(a.waffleValueStyle,l.waffle&&l.waffle.dataValueStyle),u.populateObject(a.waffleLabelStyle,l.waffle&&l.waffle.dataLabelStyle),a.ringBackgroundColor=a.ringBackgroundColor||l.ring&&l.ring.ringBackground&&l.ring.ringBackground.backgroundColor,a.columnBarBackgroundColor=a.columnBarBackgroundColor||l.columnBarBackground&&l.columnBarBackground.backgroundColor,a},b.createChartPoint=function(e,l,a,t,o){var r={color:a||"",label:void 0!==l?l||"":e&&e.alias,fieldInfo:e,iconFieldInfo:t,captionFieldInfo:o};return a&&i.setPointColor(r,a),r},b.getGaugeOthersPoint=function(e){return{label:e&&e.label||L.gaugeOthers,color:e&&e.color}},b.getWaffleOthersPoint=function(e){return{label:e&&e.label||L.waffleOthers,color:e&&e.color,iconFieldInfo:e&&e.iconFieldInfo}};var y=[{headers:{data:{AREA_DESC:L.oneMile}}},{headers:{data:{AREA_DESC:L.threeMiles}}},{headers:{data:{AREA_DESC:L.fiveMiles}}}];return b.getSeriesItemsForMultiFeatureChart=function(i,a,t){if(!a)return a;t=t||y;var o=a[0];return l.isLineLike(i)?t.map(function(i){var l=e.clone(o);return l.color=o.points[0].color,l.points.forEach(function(e){delete e.color}),l.label=c.getAreaDataValue({areaDataObject:i,fieldName:"AREA_DESC"})||"",l}):o.points.map(function(e){return{label:e.label,thickness:o.thickness,points:t.map(function(i){return b.createChartPoint(e.fieldInfo,c.getAreaDataValue({areaDataObject:i,fieldName:"AREA_DESC"})||"",e.color||o.color)})}})},b.getOriginalPointByMultiFeatureIndexes=function(e,i,l){return e[0].points[i]},b});