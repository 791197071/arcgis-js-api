// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.12/esri/copyright.txt for details.

define(["require","exports","../Logger"],function(n,r,e){function t(n,r){return r.isInstanceOf?r.isInstanceOf(n):r instanceof n}function u(n){return null==n?n:new Date(n)}function o(n){return null==n?n:!!n}function i(n){return null==n?n:n.toString()}function a(n){return null==n?n:"number"==typeof n&&isNaN(n)?0:parseFloat(n)}function s(n){return null==n?n:Math.round(parseFloat(n))}function f(n){return n&&n.constructor&&void 0!==n.constructor._meta}function l(n,r){return null!=r&&n&&!t(n,r)}function c(n){return n&&("isCollection"in n||n._meta&&n._meta.bases&&n._meta.bases.some(function(n){return"isCollection"in n}))}function p(n){return n&&n.Type?"function"==typeof n.Type?n.Type:n.Type.base:null}function y(n,r){if(!r||!r.constructor||!c(r.constructor))return v(n,r)?r:new n(r);var e=p(n.prototype.itemType),t=p(r.constructor.prototype.itemType);if(!e)return r;if(!t)return new n(r);if(e===t)return r;var u=t._meta&&t._meta.bases;return u&&-1!==u.indexOf(e)?new n(r):(v(n,r),r)}function v(n,r){return!!f(r)&&(N.error("Accessor#set","Assigning an instance of '"+(r.declaredClass||"unknown")+"' which is not a subclass of '"+g(n)+"'"),!0)}function d(n,r){return null==r?r:c(n)?y(n,r):l(n,r)?v(n,r)?r:new n(r):r}function g(n){return n&&n.prototype&&n.prototype.declaredClass||"unknown"}function b(n){switch(n){case Number:return a;case C:return s;case Boolean:return o;case String:return i;case Date:return u;default:return d.bind(null,n)}}function m(n,r){var e=b(n);return 1===arguments.length?e:e(r)}function h(n,r){return 1===arguments.length?h.bind(null,n):r?Array.isArray(r)?r.map(n):[n(r)]:r}function A(n,r){return 1===arguments.length?h(m.bind(null,n)):h(m.bind(null,n),r)}function T(n,r,e){return 0!==r&&Array.isArray(e)?e.map(function(e){return T(n,r-1,e)}):n(e)}function w(n,r,e){if(2===arguments.length)return w.bind(null,n,r);if(!e)return e;e=T(n,r,e);for(var t=r,u=e;t>0&&Array.isArray(u);)t--,u=u[0];if(void 0!==u)for(var o=0;o<t;o++)e=[e];return e}function O(n,r,e){return 2===arguments.length?w(m.bind(null,n),r):w(m.bind(null,n),r,e)}function j(n){return!!Array.isArray(n)&&!n.some(function(r){var e=typeof r;return!("string"===e||"number"===e||"function"===e&&n.length>1)})}function _(n,r){if(2===arguments.length)return _(n).call(null,r);for(var e=new Set,t=n.filter(function(n){return"function"!=typeof n}),u=n.filter(function(n){return"function"==typeof n}),o=0,i=n;o<i.length;o++){var a=i[o];"string"!=typeof a&&"number"!=typeof a||e.add(a)}var s=null,f=null;return function(n,r){if(null==n)return n;var o=typeof n,i="string"===o||"number"===o;return i&&(e.has(n)||u.some(function(n){return"string"===o&&n===String||"number"===o&&n===Number}))?n:"object"===o&&u.some(function(r){return!l(n,r)})?n:(i&&t.length?(s||(s=t.map(function(n){return"string"==typeof n?"'"+n+"'":""+n}).join(", ")),N.error("Accessor#set","'"+n+"' is not a valid value for this property, only the following values are valid: "+s)):"object"==typeof n&&u.length?(f||(f=u.map(function(n){return g(n)}).join(", ")),N.error("Accessor#set","'"+n+"' is not a valid value for this property, value must be one of "+f)):N.error("Accessor#set","'"+n+"' is not a valid value for this property"),r&&(r.valid=!1),null)}}function k(n,r){if(2===arguments.length)return k(n).call(null,r);var e={},t=[],u=[];for(var o in n.typeMap){var i=n.typeMap[o];e[o]=m(i),t.push(g(i)),u.push(o)}var a=function(){return"'"+t.join("', '")+"'"},s=function(){return"'"+u.join("', '")+"'"},c="string"==typeof n.key?function(r){return r[n.key]}:n.key;return function(r){if(n.base&&!l(n.base,r))return r;var t=c(r)||n.defaultKeyValue,u=e[t];if(!u)return N.error("Accessor#set","Invalid property value, value needs to be one of "+a()+", or a plain object that can autocast (having .type = "+s()+")"),null;if(!l(n.typeMap[t],r))return r;if("string"==typeof n.key&&!f(r)){var o={};for(var i in r)i!==n.key&&(o[i]=r[i]);return u(o)}return u(r)}}Object.defineProperty(r,"__esModule",{value:!0});var N=e.getLogger("esri.core.Accessor");r.isInstanceOf=t,r.ensureDate=u,r.ensureBoolean=o,r.ensureString=i,r.ensureNumber=a,r.ensureInteger=s,r.isClassedType=f,r.requiresType=l,r.ensureClass=d,r.ensureType=m,r.ensureArrayTyped=h,r.ensureArray=A,r.ensureNArrayTyped=w,r.ensureNArray=O,r.isOneOf=j,r.ensureOneOf=_,r.ensureOneOfType=k;var C=function(){function n(){}return n}();r.Integer=C,r.default=m});