// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.12/esri/copyright.txt for details.

define(["require","exports","../../../core/tsSupport/assignHelper","../../../core/tsSupport/extendsHelper","../../../Color","./size","./support/colors","./support/SymbologyBase","./support/utils"],function(e,o,n,a,r,t,i,c,m){function p(e,o,n,a){var r=i[o];if(r){var t=r[e.numColors]||r.stops,c="mesh"!==e.geometryType&&e.worldScale,m=c?e.view:null;switch(e.geometryType){case"point":case"multipoint":var p=n;return l({name:r.name,tags:r.tags,colors:t,noDataColor:p.noDataColor,opacity:1,sizeScheme:a,outline:p.outline,size:p.size},m);case"polyline":var y=n;return s({name:r.name,tags:r.tags,colors:t,noDataColor:y.noDataColor,opacity:1,sizeScheme:a,width:y.width},m);case"polygon":var h=n,v=a;v&&v.marker&&null!=h.markerSize&&(v.marker.size=h.markerSize);return d({name:r.name,tags:r.tags,colors:t,noDataColor:h.noDataColor,opacity:h.fillOpacity,outline:h.outline,sizeScheme:v},m);case"mesh":var w=n;return u({name:r.name,tags:r.tags,colors:t,noDataColor:w.noDataColor,opacity:w.fillOpacity});default:return}}}function l(e,o){return{name:e.name,tags:e.tags.slice(),colors:e.colors.map(function(e){return new r(e)}),noDataColor:new r(e.noDataColor),outline:{color:new r(e.outline.color),width:e.outline.width},size:o?m.toWorldScale(e.size,o):e.size,sizeScheme:e.sizeScheme,opacity:e.opacity}}function s(e,o){return{name:e.name,tags:e.tags.slice(),colors:e.colors.map(function(e){return new r(e)}),noDataColor:new r(e.noDataColor),width:o?m.toWorldScale(e.width,o):e.width,sizeScheme:e.sizeScheme,opacity:e.opacity}}function d(e,o){var n=e.sizeScheme;return n.marker.size=o?m.toWorldScale(n.marker.size,o):n.marker.size,{name:e.name,tags:e.tags.slice(),colors:e.colors.map(function(e){return new r(e)}),noDataColor:new r(e.noDataColor),outline:{color:new r(e.outline.color),width:e.outline.width},sizeScheme:n,opacity:e.opacity}}function u(e){return{name:e.name,tags:e.tags.slice(),colors:e.colors.map(function(e){return new r(e)}),noDataColor:new r(e.noDataColor),opacity:e.opacity}}var y={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},h={light:{common:{noDataColor:"#aaaaaa",outline:y.light,size:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]},dark:{common:{noDataColor:"#aaaaaa",outline:y.darker,size:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]}},v={light:{common:{noDataColor:"#aaaaaa",width:"2px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]},dark:{common:{noDataColor:"#aaaaaa",width:"2px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]}},w={light:{common:{noDataColor:"#aaaaaa",outline:y.light,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]},dark:{common:{noDataColor:"#aaaaaa",outline:y.dark,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"]}},g={name:"default",label:"Default",description:"Default theme for visualizing features by their predominant category.",schemes:{point:h,polyline:v,polygon:w}},f={default:g};return new(function(e){function o(){return e.call(this,{themeDictionary:f})||this}return a(o,e),o.prototype.getSchemes=function(e){var o=this.getRawSchemes({theme:"default",basemap:e.basemap,geometryType:e.geometryType});if(o){var n=this.getBasemapId(e.basemap,"default"),a=o.common,r=t.getSchemes({basemap:e.basemap,geometryType:e.geometryType,worldScale:e.worldScale,view:e.view}),i=r&&r.primaryScheme;return{primaryScheme:p(e,o.primary,a,i),secondarySchemes:o.secondary.map(function(o){return p(e,o,a,i)}).filter(Boolean),basemapId:n}}},o.prototype.getSchemeByName=function(e){return this.filterSchemesByName(e)},o.prototype.getSchemesByTag=function(e){return this.filterSchemesByTag(e)},o.prototype.cloneScheme=function(e){if(e){var o=n({},e);return o.colors=o.colors.map(function(e){return new r(e)}),o.noDataColor&&(o.noDataColor=new r(o.noDataColor)),"outline"in o&&o.outline&&(o.outline={color:o.outline.color&&new r(o.outline.color),width:o.outline.width}),"sizeScheme"in o&&o.sizeScheme&&(o.sizeScheme=t.cloneScheme(o.sizeScheme)),o}},o}(c))});